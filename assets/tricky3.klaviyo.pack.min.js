!function(e){e.fn.bValidator=function(a,t){return this.each(function(){new bValidator(e(this),a,t)})},bValidator=function(a,t,n){var r,i={singleError:!1,offset:{x:-23,y:-4},position:{x:"right",y:"top"},template:'<div class="{errMsgClass}"><em/>{message}</div>',templateCloseIcon:'<div style="display:table"><div style="display:table-cell">{message}</div><div style="display:table-cell"><div class="{closeIconClass}">x</div></div></div>',showCloseIcon:!0,showErrMsgSpeed:"normal",scrollToError:!0,classNamePrefix:"bvalidator_",closeIconClass:"close_icon",errMsgClass:"errmsg",errorClass:"invalid",validClass:"",lang:"en",errorMessageAttr:"data-bvalidator-msg",validateActionsAttr:"data-bvalidator",forceValidAttr:"data-bvalidator-forcevalid",modifyActionsAttr:"data-bvalidator-modifier",paramsDelimiter:":",actionsDelimiter:",",validateOn:null,errorValidateOn:"keyup",onBeforeValidate:null,onAfterValidate:null,onValidateFail:null,onValidateSuccess:null,onBeforeElementValidation:null,onAfterElementValidation:null,onBeforeAllValidations:null,onAfterAllValidations:null,validateOnSubmit:!0,stopSubmitPropagation:!0,noMsgIfExistsForInstance:[],validateTillInvalid:!1,autoModifiers:{digit:["trim"],number:["trim"],email:["trim"],url:["trim"],date:["trim"],ip4:["trim"],ip6:["trim"]},ajaxAnswerValid:"ok",ajaxDelay:300,ajaxOptions:{cache:!1},ajaxParamName:"bValue",errorMessages:{en:{"default":"Please correct this value.",equalto:"Please enter the same value again.",differs:"Please enter a different value.",minlength:"The length must be at least {0} characters",maxlength:"The length must be at max {0} characters",rangelength:"The length must be between {0} and {1}",min:"Please enter a number greater than or equal to {0}.",max:"Please enter a number less than or equal to {0}.",between:"Please enter a number between {0} and {1}.",required:"This field is required.",alpha:"Please enter alphabetic characters only.",alphanum:"Please enter alphanumeric characters only.",digit:"Please enter only digits.",number:"Please enter a valid number.",email:"Please enter a valid email address.",image:"This field should only contain image types",url:"Please enter a valid URL.",ip4:"Please enter a valid IPv4 address.",ip6:"Please enter a valid IPv6 address.",date:"Please enter a valid date in format {0}."}}},s=function(a,t,n,r){var s=a.data("ajaxData.bV"+t);if(s?clearTimeout(s.timeOut):(s={},a.data("ajaxData.bV"+t,s)),s.val=a.val(),s.lastValidated===s.val)return A.ajax(s.lastResponse);var l=e.extend({},i.ajaxOptions);if("object"!=typeof l.data&&(l.data={}),l.url=n,r){var o=!1;return l.async=!1,l.data[i.ajaxParamName]=s.val,e.ajax(l).done(function(e){s.lastValidated=s.val,s.lastResponse=e,o=A.ajax(e)}),o}s.timeOut=setTimeout(function(){var t=a.val();s.val==t&&(l.async=!0,l.data[i.ajaxParamName]=t,e.ajax(l).done(function(e){s.lastValidated=t,s.lastResponse=e,F.validate(!1,a,void 0,e)}))},i.ajaxDelay)},l=function(e){return e.is(":input")?e:e.find(":input["+i.validateActionsAttr+"], :input["+i.modifyActionsAttr+"]").not(":button, :image, :reset, :submit, :hidden, :disabled")},o=function(a){a.bind(i.validateOn+".bV"+n,{bVInstance:F},function(a){a.data.bVInstance.validate(!1,e(this))})},d=function(e,a){for(var t=0;t<a.length;t++)if(e.data("errMsg.bV"+a[t]))return!0;return!1},u=function(a,t){f(a),msg_container=e('<div class="bVErrMsgContainer"></div>').css("position","absolute"),a.data("errMsg.bV"+n,msg_container),msg_container.insertAfter(a);for(var s="",l=0;l<t.length;l++)s+="<div>"+t[l]+"</div>\n";i.showCloseIcon&&(s=i.templateCloseIcon.replace("{message}",s).replace("{closeIconClass}",i.classNamePrefix+i.closeIconClass));var o=e(i.template.replace("{errMsgClass}",i.classNamePrefix+i.errMsgClass).replace("{message}",s));o.appendTo(msg_container),o.find("."+i.classNamePrefix+i.closeIconClass).click(function(a){a.preventDefault(),e(this).closest("."+i.classNamePrefix+i.errMsgClass).css("visibility","hidden")});var d=c(a,o);if(o.css({visibility:"visible",position:"absolute",top:d.top,left:d.left}).fadeIn(i.showErrMsgSpeed),i.scrollToError){var u=o.offset().top;(null===r||u<r)&&(r=u)}},f=function(e){var a=e.data("errMsg.bV"+n);a&&(a.remove(),e.data("errMsg.bV"+n,null))},c=function(e,a){var t=e.data("errMsg.bV"+n),r=-(t.offset().top-e.offset().top+a.outerHeight()-i.offset.y),s=e.offset().left+e.outerWidth()-t.offset().left+i.offset.x,l=i.position.x,o=i.position.y;if("center"==o||"bottom"==o){var d=a.outerHeight()+e.outerHeight();"center"==o&&(r+=d/2),"bottom"==o&&(r+=d)}if("center"==l||"left"==l){var u=e.outerWidth();"center"==l&&(s-=u/2),"left"==l&&(s-=u)}return{top:r,left:s}},m=function(a,t,n,r){if(e.isFunction(i[a]))return i[a](t,n,r)},v=function(a){var t=a.attr("name");return t&&/^[^\[\]]+\[.*\]$/.test(t)?e("input:checkbox").filter(function(){var e=new RegExp(t.match(/^[^\[\]]+/)[0]+"\\[.*\\]$");return this.name.match(e)}):a},h=function(a){var t={};return a.is("input:checkbox")?t.value=a.attr("name")?t.selectedInGroup=v(a).filter(":checked").length:a.attr("checked"):a.is("input:radio")?t.value=a.attr("name")?t.value=e('input:radio[name="'+a.attr("name")+'"]:checked').length:a.val():a.is("select")?(t.selectedInGroup=e("option:selected",a).length,t.value=a.val()):a.is(":input")&&(t.value=a.val()),t},g=function(a){var t=e.trim(a).replace(new RegExp("\\s*\\"+i.actionsDelimiter+"\\s*","g"),i.actionsDelimiter);return t?t.split(i.actionsDelimiter):null},p=function(a){var t=e.trim(a).match(/^(.*?)\[(.*?)\]/);return t&&3==t.length?{name:t[1],params:t[2].split(i.paramsDelimiter)}:{name:a,params:[]}},b=function(a,t){var n,r=V(a,t);"undefined"!=typeof r&&(n=e(t).val(),n!=r&&e(t).val(r))},V=function(a,t){var n=[e(t).val()].concat(a.params);return"function"==typeof y[a.name]?y[a.name].apply(t,n):"function"==typeof window[a.name]?window[a.name].apply(t,n):void window.console.warn},x=function(e,a,t){return"function"==typeof A[e.name]?A[e.name].apply(a,[t].concat(e.params)):"function"==typeof window[e.name]?window[e.name].apply(a,[t.value].concat(e.params)):void window.console.warn},A={equalto:function(a,t){return a.value==e("#"+t).val()},differs:function(a,t){return a.value!=e("#"+t).val()},minlength:function(e,a){return e.value.length>=parseInt(a)},maxlength:function(e,a){return e.value.length<=parseInt(a)},rangelength:function(e,a,t){return e.value.length>=parseInt(a)&&e.value.length<=parseInt(t)},min:function(e,a){return e.selectedInGroup?e.selectedInGroup>=parseFloat(a):!!A.number(e)&&parseFloat(e.value)>=parseFloat(a)},max:function(e,a){return e.selectedInGroup?e.selectedInGroup<=parseFloat(a):!!A.number(e)&&parseFloat(e.value)<=parseFloat(a)},between:function(e,a,t){if(e.selectedInGroup)return e.selectedInGroup>=parseFloat(a)&&e.selectedInGroup<=parseFloat(t);if(!A.number(e))return!1;var n=parseFloat(e.value);return n>=parseFloat(a)&&n<=parseFloat(t)},required:function(a){return!(!a.value||!e.trim(a.value))},alpha:function(e){return A.regex(e,/^[a-z ._\-]+$/i)},alphanum:function(e){return A.regex(e,/^[a-z\d ._\-]+$/i)},digit:function(e){return A.regex(e,/^\d+$/)},number:function(e){return A.regex(e,/^[-+]?\d+(\.\d+)?$/)},email:function(e){return A.regex(e,/^([a-zA-Z\d_\.\-\+%])+\@(([a-zA-Z\d\-])+\.)+([a-zA-Z\d]{2,4})+$/)},image:function(e){return A.regex(e,/\.(jpg|jpeg|png|gif|bmp)$/i)},url:function(e){return A.regex(e,/^\b(https?|ftp):\/\/([-A-Z0-9.]+)(\/[-A-Z0-9+&@#\/%=~_|!:,.;]*)?(\?[A-Z0-9+&@#\/%=~_|!:,.;]*)?$/i)},regex:function(e,a,t){return"string"==typeof a&&(a=new RegExp(a,t)),a.test(e.value)},ip4:function(e){return A.regex(e,/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/)},ip6:function(e){return A.regex(e,/^(?:(?:(?:[A-F\d]{1,4}:){5}[A-F\d]{1,4}|(?:[A-F\d]{1,4}:){4}:[A-F\d]{1,4}|(?:[A-F\d]{1,4}:){3}(?::[A-F\d]{1,4}){1,2}|(?:[A-F\d]{1,4}:){2}(?::[A-F\d]{1,4}){1,3}|[A-F\d]{1,4}:(?::[A-F\d]{1,4}){1,4}|(?:[A-F\d]{1,4}:){1,5}|:(?::[A-F\d]{1,4}){1,5}|:):(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)|(?:[A-F\d]{1,4}:){7}[A-F\d]{1,4}|(?:[A-F\d]{1,4}:){6}:[A-F\d]{1,4}|(?:[A-F\d]{1,4}:){5}(?::[A-F\d]{1,4}){1,2}|(?:[A-F\d]{1,4}:){4}(?::[A-F\d]{1,4}){1,3}|(?:[A-F\d]{1,4}:){3}(?::[A-F\d]{1,4}){1,4}|(?:[A-F\d]{1,4}:){2}(?::[A-F\d]{1,4}){1,5}|[A-F\d]{1,4}:(?::[A-F\d]{1,4}){1,6}|(?:[A-F\d]{1,4}:){1,7}:|:(?::[A-F\d]{1,4}){1,7})$/i)},date:function(e,a){if(10==e.value.length&&10==a.length){var t=a.match(/[^mdy]+/g);if(2==t.length&&1==t[0].length&&t[0]==t[1]){for(var n=e.value.split(t[0]),r=a.split(t[0]),i=0;i<3;i++)if("dd"==r[i])var s=n[i];else if("mm"==r[i])var l=n[i];else if("yyyy"==r[i])var o=n[i];var d=new Date(o,l-1,s);return d.getMonth()+1==l&&d.getDate()==s&&d.getFullYear()==o}}return!1},extension:function(){var e=arguments[0],a="";if(!arguments[1])return!1;for(var t=1;t<arguments.length;t++)a+=arguments[t],t!=arguments.length-1&&(a+="|");return A.regex(e,"\\.("+a+")$","i")},ajax:function(e){return e==i.ajaxAnswerValid}},y={trim:function(a){return e.trim(a)}},F=this;window.bValidatorOptions&&e.extend(!0,i,window.bValidatorOptions),t&&e.extend(!0,i,t);var w=a.data("bValidators");if(w||(w={},a.data("bValidators",w)),a.data("bValidator")){if(!n)return a.data("bValidator");if(w[n])return w[n]}else n||(n="first"),a.data("bValidator",this);w[n]=this,a.is("form")&&(i.validateOnSubmit&&a.bind("submit.bV"+n,function(e){return!!F.validate(!1,void 0,1)||(i.stopSubmitPropagation?(e.stopImmediatePropagation(),!1):void 0)}),a.bind("reset.bV"+n,function(){F.reset()})),i.validateOn&&o(l(a)),this.validate=function(t,c,V,y,w){var I=!0,M=c?c:l(a);if(r=null,"undefined"==typeof y&&m("onBeforeAllValidations",M)===!1||M.each(function(){var a,r=g(e(this).attr(i.validateActionsAttr)),l=g(e(this).attr(i.modifyActionsAttr)),c=-1,M=[],P=0;if(l)for(var C=0;C<l.length;C++)a=p(l[C]),a.name&&b(a,this);if(!r)return!0;for(var C=0;C<r.length;C++)if(a=p(r[C]),a.name){if(i.autoModifiers&&i.autoModifiers[a.name])for(var j=0;j<i.autoModifiers[a.name].length;j++)b(p(i.autoModifiers[a.name][j]),this);if("required"==a.name)var O=1;else if("ajax"==a.name)var E=1;if("valempty"==a.name)var D=1;else M[++c]=a}var k,T=h(e(this)),N=[];if(!V&&E&&"undefined"==typeof y){for(var $=0,C=0;C<M.length&&"ajax"!=M[C].name;C++)if(!x(M[C],this,T)){$=1;break}if(!$&&(y=s(e(this),n,a.params[0]),"undefined"==typeof y))return!0}if(i.noMsgIfExistsForInstance.length&&d(e(this),i.noMsgIfExistsForInstance)&&(t=1),(O||D||A.required(T))&&"true"!=e(this).attr(i.forceValidAttr)||(P=1),!P){var _=e(this).attr(i.errorMessageAttr),q=0;if(e(this).data("checked.bV"+n,1),m("onBeforeElementValidation",e(this))!==!1)for(var C=0;C<M.length;C++)if("valempty"!=M[C].name){if((i.validateTillInvalid||w)&&N.length)break;if(m("onBeforeValidate",e(this),M[C].name)!==!1){if("ajax"==M[C].name){if($)continue;k=V||"undefined"==typeof y?!!N.length||s(e(this),n,M[C].params[0],1):A.ajax.apply(this,[y])}else k=x(M[C],this,T);if(m("onAfterValidate",e(this),M[C].name,k)!==!1)if(k)m("onValidateSuccess",e(this),M[C].name);else{if(t)N[N.length]="";else if(!q){if(_)q=1;else if(i.singleError&&N.length)q=1,_="";else if(i.errorMessages[i.lang]&&i.errorMessages[i.lang][M[C].name])_=i.errorMessages[i.lang][M[C].name];else if(i.errorMessages.en[M[C].name])_=i.errorMessages.en[M[C].name];else{var G=e(this).attr(i.errorMessageAttr+"-"+M[C].name);_=G?G:i.errorMessages[i.lang]&&i.errorMessages[i.lang]["default"]?i.errorMessages[i.lang]["default"]:i.errorMessages.en["default"]}if(_.indexOf("{"))for(var R=0;R<M[C].params.length;R++)_=_.replace(new RegExp("\\{"+R+"\\}","g"),M[C].params[R]);N.length&&"required"==M[C].name||(N[N.length]=_),_=null}I=!1,m("onValidateFail",e(this),M[C].name,N)}}}var S=m("onAfterElementValidation",e(this),N)}if(!t&&S!==!1&&e(this).data("checked.bV"+n)){var B=e(this).is("input:checkbox,input:radio")?1:0;if(N.length){if(0!==S&&u(e(this),N),B||(e(this).removeClass(i.classNamePrefix+i.validClass),i.errorClass&&e(this).addClass(i.classNamePrefix+i.errorClass)),i.errorValidateOn){i.validateOn&&e(this).unbind(i.validateOn+".bV"+n);var Z=B||e(this).is("select,input:file")?"change":i.errorValidateOn;if(B){var z=e(this).is("input:checkbox")?v(e(this)):e('input:radio[name="'+e(this).attr("name")+'"]');e(z).unbind(".bVerror"+n),e(z).bind("change.bVerror"+n,{bVInstance:F,groupLeader:e(this)},function(e){e.data.bVInstance.validate(!1,e.data.groupLeader)})}else e(this).unbind(".bVerror"+n),e(this).bind(Z+".bVerror"+n,{bVInstance:F},function(a){a.data.bVInstance.validate(!1,e(this))})}}else 0!==S&&f(e(this)),B||(e(this).removeClass(i.classNamePrefix+i.errorClass),i.validClass&&e(this).addClass(i.classNamePrefix+i.validClass)),i.validateOn&&(e(this).unbind(i.validateOn+".bV"+n),o(e(this))),e(this).data("checked.bV"+n,0)}return(!i.singleError&&!w||I!==!1)&&void 0}),m("onAfterAllValidations",M,I),r&&!c&&(e(window).scrollTop()>r||e(window).scrollTop()+e(window).height()<r)){var P=navigator.userAgent.toLowerCase();e(P.indexOf("chrome")>-1||P.indexOf("safari")>-1?"body":"html").animate({scrollTop:r-10},{duration:"slow"})}return I},this.getOptions=function(){return i},this.getValidators=this.getActions=function(){return A},this.getModifiers=function(){return y},this.isValid=function(e){return this.validate(!0,e,1,void 0,!0)},this.removeMsg=this.removeErrMsg=function(e){f(e)},this.showMsg=function(e,a){e.length&&("string"==typeof a&&(a=[a]),u(e,a))},this.getInputs=function(){return l(a)},this.bindValidateOn=function(e){o(e)},this.reset=function(){elements=l(a),i.validateOn&&o(elements),elements.each(function(){f(e(this)),e(this).unbind(".bVerror"+n),e(this).removeClass(i.classNamePrefix+i.errorClass),e(this).removeClass(i.classNamePrefix+i.validClass),e(this).removeData("ajaxData.bV"+n),e(this).removeData("errMsg.bV"+n),e(this).removeData("checked.bV"+n)})},this.destroy=function(){a.is("form")&&a.unbind(".bV"+n),this.reset(),a.removeData("bValidator"),a.removeData("bValidators")}}}(jQuery);
$(document).ready(function(){$(".klaviyo-embed").each(function(){var e=$(this);$("form",e).bValidator({singleError:!0}),$("form",e).submit(function(a){var s=$(this),t=s.attr("data-ajax-submit"),o=(new Date).getTimezoneOffset()/-60;$(".timeOffset",s).length?$(".timeOffset",s).val(o):s.append('<input type="hidden" value="'+o+'" class="timeOffset klaviyo-field" name="$timezone_offset"/>');var i=s.find(".klaviyo-field").serialize(),r=s.find(".klaviyo-custom-property").map(function(){return $(this).attr("name")}).get();return r.length&&(i+="&$fields="+r.join(",")),s.data("bValidator").isValid()&&$.post(t,i,function(a){KlaviyoEmbedFormCallBacks.ProcessResponse(a,e)}),a.preventDefault(),!1})})});var KlaviyoEmbedFormCallBacks={ProcessResponse:function(e,a){e.success?KlaviyoEmbedFormCallBacks.Success(e,a):KlaviyoEmbedFormCallBacks.Error(e,a)},Success:function(e,a){T3Core.TrackUserSignUpEmbed(a),T3Core.TrackFacebookCompleteRegistration({content_name:a.attr("data-ga-action")});var s="undefined"!=typeof _t3klaviyoembed&&_t3klaviyoembed.success_message?_t3klaviyoembed.success_message:"Thank you!";$(".klaviyo_messages .success_message",a).text(s).show()},Error:function(e,a){$(".klaviyo_messages .error_message",a).html("<p>"+e.errors[0]+"</p>").show()}};
!function(e){var o=function(o,i){var a={CookieName:"KlaviyoPopup",SessionCookieName:"KlaviyoPopupSession",Visits:[],Delay:1e4,PageViewNumber:1,CloseSelectors:[],ShowSelectors:[],ShowPopupOnCurrentPage:!1,InnerWrapper:".modal",SignupKey:"signup",HidePopupOnSuccess:!0,HidePopupOnSuccessTimeout:5e3,ShowAlertMessage:!0,AjaxSubmitAttr:"data-ajax-submit",BValidatorOptions:{singleError:!0},CallBacks:{OnSuccess:function(){},OnError:function(){},OnDisplayed:function(){},OnClosed:function(){},OnFormSubmitted:function(){},BeforeSubmit:function(){}},MessageWrapperSelectors:{Success:".klaviyo_messages .success_message",Error:".klaviyo_messages .error_message"},Messages:{Success:"Thank you!"},IsBlocking:!1};e.extend(a,i||{});var s={VisitsCookieTracker:{Status:"",PageView:0,Visits:0,PopupAlreadyShownOnVisit:[]},CookiesValues:{NotSubmitted:"NotSubmitted",HasSubmitted:"HasSubmitted",ShowOnNextVisit:"ShowOnNextVisit",ErrorInSubmitted:"ErrorInSubmitted"},MainWrapper:o,KForm:e("form",this.MainWrapper)},t={Initialize:function(){this.Hide(!1),a.IsBlocking?this.SetupModalPopup():this.ReadAndSetupCookieValues(),this.InitCustomEvents()},InitDefaultKlaviyoCookies:function(){var e="klaPages",o=parseInt(T3Core.CookieManager.ReadCookie(e),10);o=isNaN(o)?1:o+1,T3Core.CookieManager.CreateCookie(e,o,365)},InitCustomEvents:function(){for(var o=0;o<a.CloseSelectors.length;o++){var i=e(a.CloseSelectors[o]);i.click(function(e){return t.Hide(!0),e.stopPropagation(),!1})}for(var o=0;o<a.ShowSelectors.length;o++){var i=e(a.ShowSelectors[o]);i.click(function(e){return t.Show(!0),e.stopPropagation(),!1})}a.IsBlocking||(e(document).keydown(function(e){keycode=null==e?event.keyCode:e.which,27==keycode&&t.Hide(!0)}),s.MainWrapper.click(function(){e(this).hasClass("modalize")&&t.Hide(!0)})),e(a.InnerWrapper,s.MainWrapper).click(function(e){e.stopPropagation()})},Hide:function(e){s.MainWrapper.removeClass("modalize"),t.CallBackHandler.OnClosed(e)},SetupModalPopup:function(){var e=this.ReadJsonFromCookie(a.CookieName);null==e?this.Show():this.Hide()},ReadAndSetupCookieValues:function(){var e=T3Core.CookieManager.ReadCookie(a.SessionCookieName),o=this.ReadJsonFromCookie(a.CookieName);if(null==o&&null==e)T3Core.CookieManager.CreateCookie(a.SessionCookieName,1),this.SaveJsonToCookie(a.CookieName,s.CookiesValues.ShowOnNextVisit,1,1,"",30),o=this.ReadJsonFromCookie(a.CookieName);else if(null==o&&(this.SaveJsonToCookie(a.CookieName,s.CookiesValues.ShowOnNextVisit,1,1,"",30),o=this.ReadJsonFromCookie(a.CookieName)),null==e){var i=o,n=i.Visits+1,r=i.PageView;T3Core.CookieManager.CreateCookie(a.SessionCookieName,n),i.Status==s.CookiesValues.ShowOnNextVisit&&this.SaveJsonToCookie(a.CookieName,s.CookiesValues.ShowOnNextVisit,r,n,"",30)}o.Status==s.CookiesValues.ShowOnNextVisit&&a.ShowPopupOnCurrentPage&&t.ProcessCookiesValuesAndShowPopupIfNeeded()},ReadJsonFromCookie:function(e){var o=T3Core.CookieManager.ReadCookie(e),i=null;if(null!=o)try{i=JSON.parse(o)}catch(a){o.indexOf(s.CookiesValues.HasSubmitted)!=-1&&(t.SaveJsonToCookie(e,s.CookiesValues.HasSubmitted,"","","",365),i=JSON.parse(T3Core.CookieManager.ReadCookie(e)))}return i},ProcessCookiesValuesAndShowPopupIfNeeded:function(){var o=this.ReadJsonFromCookie(a.CookieName),i={PageView:0,Visits:0,NeedToShowPopupOnCurrentVisit:!1,NeedToShowPopupOnCurrentPageView:!1,PopupAlreadyShown:!1,ShowPopup:!1};if(i.PageView=parseInt(o.PageView),i.Visits=parseInt(o.Visits),o.PopupAlreadyShownOnVisit.length>0&&(i.PopupAlreadyShown=e.inArray(i.Visits,o.PopupAlreadyShownOnVisit)!=-1),i.NeedToShowPopupOnCurrentVisit=e.inArray(i.Visits,a.Visits)!=-1&&!i.PopupAlreadyShown,i.NeedToShowPopupOnCurrentPageView=i.PageView==a.PageViewNumber,i.NeedToShowPopupOnCurrentVisit&&i.PageView<=a.PageViewNumber)if(i.NeedToShowPopupOnCurrentPageView)this.SaveJsonToCookie(a.CookieName,s.CookiesValues.ShowOnNextVisit,1,i.Visits,i.Visits,30);else{var t=i.PageView+1;this.SaveJsonToCookie(a.CookieName,s.CookiesValues.ShowOnNextVisit,t,i.Visits,"",30)}i.Visits>a.Visits[a.Visits.length-1],i.ShowPopup=i.NeedToShowPopupOnCurrentVisit&&i.NeedToShowPopupOnCurrentPageView,i.ShowPopup&&this.Show(!1)},Show:function(e){var o=e?1e3:a.Delay;setTimeout(function(){s.MainWrapper.addClass("modalize"),t.CallBackHandler.OnDisplayed(),t.InitBValidator(),t.InitAjaxSubmit()},o)},InitBValidator:function(){s.KForm.bValidator(a.BValidatorOptions)},InitAjaxSubmit:function(){s.KForm.submit(function(o){var i=e(this);if(i.data("bValidator").isValid()){t.CallBackHandler.BeforeSubmit();var s=i.attr(a.AjaxSubmitAttr),n=(new Date).getTimezoneOffset()/-60;e(".timeOffset",i).length?e(".timeOffset",i).val(n):i.append('<input type="hidden" value="'+n+'" class="timeOffset klaviyo-field" name="$timezone_offset"/>');var r=decodeURIComponent(i.find(".klaviyo-field").serialize()),u=e(this).find(".klaviyo-custom-property").map(function(){return e(this).attr("name")}).get();return u.length&&(r+="&$fields="+u.join(",")),e.post(s,r,t.AjaxFormSubmitCallBack),t.CallBackHandler.OnFormSubmitted(),o.stopPropagation(),!1}})},AjaxFormSubmitCallBack:function(o){if(o.success){t.UserHasSignedUp=!0,t.SaveJsonToCookie(a.CookieName,s.CookiesValues.HasSubmitted,"","","",365);var i=e(a.MessageWrapperSelectors.Success,s.MainWrapper);i.append(a.Messages.Success).css("display","block"),t.CallBackHandler.OnSuccess(o),a.HidePopupOnSuccess&&setTimeout(function(){t.Hide(!1)},a.HidePopupOnSuccessTimeout)}else{var n=e(a.MessageWrapperSelectors.Error,s.MainWrapper);e(o.errors).each(function(){n.append("<p>"+this+"</p>")}),n.css("display","block"),t.CallBackHandler.OnError(o)}},SaveJsonToCookie:function(e,o,i,a,t,n){s.VisitsCookieTracker.Status=o,s.VisitsCookieTracker.PageView=i,s.VisitsCookieTracker.Visits=a,""!=t&&s.VisitsCookieTracker.PopupAlreadyShownOnVisit.push(t),T3Core.CookieManager.CreateCookie(e,JSON.stringify(s.VisitsCookieTracker),n)},UserHasSignedUp:!1};t.CallBackHandler={OnClosed:function(e){a.CallBacks.OnClosed&&a.CallBacks.OnClosed(e&&!t.UserHasSignedUp)},OnFormSubmitted:function(){a.CallBacks.OnFormSubmitted&&a.CallBacks.OnFormSubmitted()},OnDisplayed:function(){a.CallBacks.OnDisplayed&&a.CallBacks.OnDisplayed()},OnError:function(e){a.CallBacks.OnError&&a.CallBacks.OnError(e)},OnSuccess:function(e){a.CallBacks.OnSuccess&&a.CallBacks.OnSuccess(e,s.MainWrapper)},BeforeSubmit:function(){a.CallBacks.BeforeSubmit&&a.CallBacks.BeforeSubmit()}},function(){var e=T3Core.GetQueryStringByKey(a.SignupKey);""!=e?1==e&&(t.Initialize(),t.Show()):t.Initialize(),t.InitDefaultKlaviyoCookies()}()};e.fn.KlaviyoPopup=function(e){return new o(this,e)}}(jQuery);
var T3UtmCookie;T3UtmCookie=function(){function e(e){null==e&&(e={}),this._cookieNamePrefix="_uc_",this._domain=e.domain,this._sessionLength=e.sessionLength||1,this._cookieExpiryDays=e.cookieExpiryDays||365,this._additionalParams=e.additionalParams||[],this._utmParams=["utm_source","utm_medium","utm_campaign","utm_term","utm_content"],this.writeInitialReferrer(),this.writeLastReferrer(),this.writeInitialLandingPageUrl(),this.setCurrentSession(),this.additionalParamsPresentInUrl()&&this.writeAdditionalParams(),this.utmPresentInUrl()&&this.writeUtmCookieFromParams()}return e.prototype.createCookie=function(e,t,i,r,o,a){var n,s,m,l,d,u;u=null,i&&(d=new Date,d.setTime(d.getTime()+24*i*60*60*1e3),u=d),s=null!=u?"; expires="+u.toGMTString():"",m=null!=r?"; path="+r:"; path=/",n=null!=o?"; domain="+o:"",l=null!=a?"; secure":"",document.cookie=this._cookieNamePrefix+e+"="+escape(t)+s+m+n+l},e.prototype.readCookie=function(e){var t,i,r,o;for(o=this._cookieNamePrefix+e+"=",i=document.cookie.split(";"),r=0;r<i.length;){for(t=i[r];" "===t.charAt(0);)t=t.substring(1,t.length);if(0===t.indexOf(o))return t.substring(o.length,t.length);r++}return null},e.prototype.eraseCookie=function(e){this.createCookie(e,"",-1,null,this._domain)},e.prototype.getParameterByName=function(e){var t,i,r;return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),i="[\\?&]"+e+"=([^&#]*)",t=new RegExp(i),r=t.exec(window.location.search),r?decodeURIComponent(r[1].replace(/\+/g," ")):""},e.prototype.additionalParamsPresentInUrl=function(){var e,t,i,r;for(r=this._additionalParams,e=0,t=r.length;e<t;e++)if(i=r[e],this.getParameterByName(i))return!0;return!1},e.prototype.utmPresentInUrl=function(){var e,t,i,r;for(r=this._utmParams,e=0,t=r.length;e<t;e++)if(i=r[e],this.getParameterByName(i))return!0;return!1},e.prototype.writeCookie=function(e,t){this.createCookie(e,t,this._cookieExpiryDays,null,this._domain)},e.prototype.writeAdditionalParams=function(){var e,t,i,r,o;for(r=this._additionalParams,e=0,t=r.length;e<t;e++)i=r[e],o=this.getParameterByName(i),this.writeCookie(i,o)},e.prototype.writeUtmCookieFromParams=function(){var e,t,i,r,o;for(r=this._utmParams,e=0,t=r.length;e<t;e++)i=r[e],o=this.getParameterByName(i),this.writeCookie(i,o)},e.prototype.writeCookieOnce=function(e,t){var i;i=this.readCookie(e),i||this.writeCookie(e,t)},e.prototype._sameDomainReferrer=function(e){var t;return t=document.location.hostname,e.indexOf(this._domain)>-1||e.indexOf(t)>-1},e.prototype._isInvalidReferrer=function(e){return""===e||void 0===e},e.prototype.writeInitialReferrer=function(){var e;e=document.referrer,this._isInvalidReferrer(e)&&(e="direct"),this.writeCookieOnce("referrer",e)},e.prototype.writeLastReferrer=function(){var e;e=document.referrer,this._sameDomainReferrer(e)||(this._isInvalidReferrer(e)&&(e="direct"),this.writeCookie("last_referrer",e))},e.prototype.writeInitialLandingPageUrl=function(){var e;e=this.cleanUrl(),e&&this.writeCookieOnce("initial_landing_page",e)},e.prototype.initialReferrer=function(){return this.readCookie("referrer")},e.prototype.lastReferrer=function(){return this.readCookie("last_referrer")},e.prototype.initialLandingPageUrl=function(){return this.readCookie("initial_landing_page")},e.prototype.incrementVisitCount=function(){var e,t,i;e="visits",t=parseInt(this.readCookie(e),10),i=1,i=isNaN(t)?1:t+1,this.writeCookie(e,i)},e.prototype.visits=function(){return this.readCookie("visits")},e.prototype.setCurrentSession=function(){var e,t;e="current_session",t=this.readCookie(e),t||(this.createCookie(e,"true",this._sessionLength/24,null,this._domain),this.incrementVisitCount())},e.prototype.cleanUrl=function(){var e;return e=window.location.search.replace(/utm_[^&]+&?/g,"").replace(/&$/,"").replace(/^\?$/,""),window.location.origin+window.location.pathname+e+window.location.hash},e}();var T3UtmForm,_uf;T3UtmForm=function(){function e(e){null==e&&(e={}),this._utmParamsMap={},this._utmParamsMap.utm_source=e.utm_source_field||"TRICKY_UTM_SOURCE",this._utmParamsMap.utm_medium=e.utm_medium_field||"TRICKY_UTM_MEDIUM",this._utmParamsMap.utm_campaign=e.utm_campaign_field||"TRICKY_UTM_CAMPAIGN",this._utmParamsMap.utm_content=e.utm_content_field||"TRICKY_UTM_CONTENT",this._utmParamsMap.utm_term=e.utm_term_field||"TRICKY_UTM_TERM",this._additionalParamsMap=e.additional_params_map||{},this._initialReferrerField=e.initial_referrer_field||"TRICKY_IREFERRER",this._lastReferrerField=e.last_referrer_field||"TRICKY_LREFERRER",this._initialLandingPageField=e.initial_landing_page_field||"TRICKY_ILANDING",this._visitsField=e.visits_field||"TRICKY_VISITS",this._addToForm=e.add_to_form||"all",this._formQuerySelector=e.form_query_selector||"form.track",this.utmCookie=new T3UtmCookie({domain:e.domain,sessionLength:e.sessionLength,cookieExpiryDays:e.cookieExpiryDays,additionalParams:Object.getOwnPropertyNames(this._additionalParamsMap)}),"none"!==this._addToForm&&this.addAllFields()}return e.prototype.addAllFields=function(){var e,t,i,r;i=this._utmParamsMap;for(t in i)e=i[t],this.addFormElem(e,this.utmCookie.readCookie(t));r=this._additionalParamsMap;for(t in r)e=r[t],this.addFormElem(e,this.utmCookie.readCookie(t));this.addFormElem(this._initialReferrerField,this.utmCookie.initialReferrer()),this.addFormElem(this._lastReferrerField,this.utmCookie.lastReferrer()),this.addFormElem(this._initialLandingPageField,this.utmCookie.initialLandingPageUrl()),this.addFormElem(this._visitsField,this.utmCookie.visits())},e.prototype.addFormElem=function(e,t){var i,r,o,a,n;if(t&&(i=document.querySelectorAll(this._formQuerySelector),i.length>0))if("first"===this._addToForm)r=i[0],r.insertBefore(this.getFieldEl(e,t),r.firstChild);else for(a=0,n=i.length;a<n;a++)o=i[a],o.insertBefore(this.getFieldEl(e,t),o.firstChild)},e.prototype.getFieldEl=function(e,t){var i;return i=document.createElement("input"),i.type="hidden",i.name=e,i.value=t,i.className="klaviyo-field klaviyo-custom-property",i},e}(),_uf=window._uf||{},window.T3UtmForm=new T3UtmForm(_uf);